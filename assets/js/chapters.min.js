class ChapterTimeline extends(videojs.getComponent("Component")){constructor(e,t={}){super(e,t),t.left&&t.width&&this.setPosition(t.left,t.width)}createEl(){const e=videojs.dom.createEl("div",{className:"vjs-chapter-timeline"}),t=videojs.dom.createEl("div",{className:"vjs-chapter-timeline-progress"});return e.append(t),e}setPosition(e,t){this.el().style.left=e,this.el().style.width=t}updateProgress(e){this.el().querySelector(".vjs-chapter-timeline-progress").style.width=`${e}%`}}function chaptersTimeline(){const e=this,t=()=>{const[t]=Array.from(e.textTracks()).filter((e=>"chapters"===e.kind))??[];return t},r=()=>{const r=e.getChild("controlBar").getChild("progressControl").getChild("seekBar").getChild("mouseTimeDisplay").getChild("timeTooltip");r.update=function(o,i,s){const l=(e=>{const r=t(),o=r?.cues;if(o)return Array.from(o).find((t=>e>=t.startTime&&e<=t.endTime))})(i*e.duration());l?(r.el().classList.add("vjs-time-tooltip-with-chapter-title"),r.el().innerHTML=`<span class="vjs-time-tooltip-chapter-title">${l.text}</span>${s}`):(r.write(s),r.el().classList.remove("vjs-time-tooltip-with-chapter-title"))}},o=r=>{const o=e.getChild("controlBar").getChild("progressControl"),i=e.getChild("controlBar").getChild("progressControl").getChild("seekBar").calculateDistance(r)*e.duration(),s=t(),l=s?.cues,n=o.el().querySelectorAll(".vjs-chapter-timeline");l&&Array.from(l).forEach(((e,t)=>{const r=n[t];r&&(i>=e.startTime&&i<=e.endTime?r.classList.add("vjs-chapter-timeline-current"):r.classList.remove("vjs-chapter-timeline-current"))}))},i=()=>{const t=e.getChild("controlBar").getChild("progressControl");t.el().querySelectorAll(".vjs-chapter-timeline")?.forEach((e=>{e.classList.remove("vjs-chapter-timeline-current")}))},s=()=>{const r=e.currentTime(),o=t(),i=o?.cues;if(!i)return;const s=e.getChild("controlBar").getChild("progressControl").el().querySelectorAll(".vjs-chapter-timeline");Array.from(i).forEach(((e,t)=>{const o=s[t];if(o){const t=o.querySelector(".vjs-chapter-timeline-progress");if(r>=e.endTime)t.style.width="100%";else if(r>=e.startTime&&r<=e.endTime){const o=(r-e.startTime)/(e.endTime-e.startTime)*100;t.style.width=`${o}%`}else t.style.width="0%"}}))},l=()=>{const o=t(),i=o?.cues,s=e.getChild("controlBar").getChild("progressControl").getChild("seekBar");if(s.el().querySelectorAll(".vjs-chapter-timeline").forEach((e=>{e.remove()})),!i)return;const l=e.duration();Array.from(i).forEach((t=>{const r=t.startTime/l*100,o=t.endTime/l*100,i=new ChapterTimeline(e,{left:`${r}%`,width:o-r+"%"});s.addChild(i)})),r()};e.on("loadedmetadata",(async()=>{try{await new Promise((e=>{let r=0;const o=()=>{const i=t();i?e(i):r<12&&(r++,setTimeout(o,250))};o()})),l();const r=e.getChild("controlBar").getChild("progressControl");r.on("mousemove",o),r.on("touchmove",o),r.on("mouseleave",i)}catch{}})),e.on("timeupdate",s),e.on("dispose",(()=>{e.off("loadedmetadata",l),e.off("timeupdate",s);const t=e.getChild("controlBar").getChild("progressControl");t.off("mousemove",o),t.off("touchmove",o),t.off("mouseleave",i)}))}videojs.registerComponent("ChapterTimeline",ChapterTimeline),videojs.registerPlugin("chaptersTimeline",chaptersTimeline);